(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{2365:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/profile",function(){return l(934)}])},5494:function(e,a){"use strict";a.Z={src:"/_next/static/media/general.7095fc5d.png",height:506,width:500,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAxUlEQVR42mPABX6UNDP+a21nhAt8K29n/5zTovGtqFX3Z207N1zieWgHE4j+mNtm/qG0x/N7cbPW9/JWh9/1bVJ/G9uEwYreJ7WJfMjvjXhX3Jn+PrvJ5H99P/+fhnaNP41tSgwvPKpE38R3ur0vnxT3oayt/ENVQ8WnjnLjX+2NKv+bujgZXgY0sL6JbBL8kNth+LmizfZLXaPdl+Zam58tDZIYLn9TO5X9TXs9O4z/pbUK4ou38W2MH9PyGVG82dIA5gMAcORU4v0N6lsAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},6775:function(e,a,l){"use strict";var r=l(5893);l(7294);var i=l(511),t=l(5675),s=l.n(t),n=l(5494);a.Z=e=>{let{isVisible:a,handleBackdropClick:l,title:t,message:d}=e;return(0,r.jsx)(i.Z,{isVisible:a,handleBackdropClick:l,children:(0,r.jsxs)("div",{className:"w-100 p-5",children:[(0,r.jsx)("div",{className:"qb-popup-illustration-wrapper pb-3 w-100 d-flex align-items-center justify-content-center",children:(0,r.jsx)(s(),{src:n.Z,alt:"success",className:"qb-popup-illustration"})}),(0,r.jsx)("h3",{className:"qb-title mb-0 pb-3 pt-5",children:t}),(0,r.jsx)("p",{className:"qb-description mb-0 pb-4",children:d})]})})}},934:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return T}});var r=l(5893),i=l(7294),t=l(9008),s=l.n(t),n=l(1163),d=l(5353),o=l(4013),u=l(5775),p=l(6264),c=l(7953),y=l(4047),m=l(9655);let h={name:0,email:1,phone:2,address:3,country:4,state:5,city:6,password:7,referral:8,dob:9,gender:10,marital:11,anniversary:12,checkBox:13},v=[{label:"Male",value:"Male"},{label:"Female",value:"Female"},{label:"Prefer not to answer/other",value:"Prefer not to answer/other"}],b=[{label:"Single",value:"Single"},{label:"Married",value:"Married"},{label:"Prefer not to answer/other",value:"Prefer not to answer/other"}];var f=e=>{let{navigateToOtp:a,customerDetails:l,token:t,successPopup:s}=e,[n,d]=(0,i.useState)([{label:"Name",fieldname:"name",placeholder:"John Doe",value:"",id:1,keyboardType:"default",error:null,isRequired:!0,emptyErrorMessage:"Name is required. Please provide your name.",inputWidthSize:"12"},{label:"Email",fieldname:"email",placeholder:"johndoe@company.com",value:"",id:2,keyboardType:"email",error:null,isRequired:!0,emptyErrorMessage:"Email is required. Please provide your email address.",inputWidthSize:"6"},{label:"Phone",fieldname:"phone",placeholder:"999 999 9999",value:"",countryCodeValue:"91",id:3,keyboardType:"phone",error:null,isRequired:!0,inputFieldType:"DEFAULT",emptyErrorMessage:"Phone number is required. Please provide your Phone number.",inputWidthSize:"6"},{label:"Address",fieldname:"address",value:"",id:9,keyboardType:"default",error:null,isRequired:!1,inputFieldType:"MULTI_LINE",inputWidthSize:"12"},{label:"Country",fieldname:"country",placeholder:"India",value:"",id:10,keyboardType:"default",error:null,isRequired:!0,inputFieldType:"SELECT",isDropdownOpen:!1,selectBoxType:"country",emptyErrorMessage:"Country name is required. Please select your Country.",inputWidthSize:"12"},{label:"State",fieldname:"state",placeholder:"Karnataka",value:"",id:11,keyboardType:"default",error:null,isRequired:!0,inputFieldType:"SELECT_TYPE",isDropdownOpen:!1,selectBoxType:"state",emptyErrorMessage:"State is required. Please select your State.",inputWidthSize:"6"},{label:"City",fieldname:"city",placeholder:"Bengaluru",value:"",id:12,keyboardType:"default",error:null,isRequired:!0,inputFieldType:"SELECT_TYPE",isDropdownOpen:!1,selectBoxType:"city",emptyErrorMessage:"City name is required. Please select your City.",inputWidthSize:"6"},{label:"Password",fieldname:"password",placeholder:"********",value:"",id:4,keyboardType:"password",error:null,isRequired:!0,isPassword:!0,isPasswordVisible:!1,emptyErrorMessage:"Password is required. Please provide a suitable password.",inputWidthSize:"12"},{label:"Referral code",fieldname:"referral",placeholder:"AXLTYD",value:"",id:6,keyboardType:"default",error:null,isRequired:!1},{label:"Date of birth",fieldname:"dob",placeholder:"dd/mm/yyyy",value:"",id:13,keyboardType:"date",error:null,isRequired:!0,emptyErrorMessage:"Date of birth is required. Please provide your birth date.",inputWidthSize:"6"},{label:"Gender",fieldname:"gender",placeholder:"Select",value:"",id:14,keyboardType:"default",error:null,isRequired:!0,inputFieldType:"SELECT",isDropdownOpen:!1,selectBoxType:"gender",emptyErrorMessage:"Gender is required. Please provide your gender.",inputWidthSize:"6"},{label:"Marital status",fieldname:"marital",placeholder:"Select",value:"",id:15,keyboardType:"default",error:null,isRequired:!1,inputFieldType:"SELECT",isDropdownOpen:!1,selectBoxType:"marital",inputWidthSize:"6"},{label:"Anniversary date",fieldname:"anniversary",placeholder:"dd/mm/yyyy",value:"",id:16,keyboardType:"date",error:null,isRequired:!1,isInputHidden:!0,inputWidthSize:"6"},{label:"I agree to receive loyalty rewards, offers and updates via email and text.",value:!0,id:17,error:null,isRequired:!0,emptyErrorMessage:"Please agree to receive loyalty reward communications if you wish to signup to our loyalty program.",inputWidthSize:"12",inputFieldType:"CHECKBOX"}]),[o,f]=(0,i.useState)({country:c.Ju,state:[],city:[],gender:v,marital:b}),[g,w]=(0,i.useState)(null),[x,T]=(0,i.useState)(null),[S,E]=(0,i.useState)(null),[P,q]=(0,i.useState)([]),[k,C]=(0,i.useState)([]),[j,A]=(0,i.useState)(null),[N,R]=(0,i.useState)(!1),{nameValidation:D,emailValidation:O,passwordValidation:L,returnErrorTexts:F}=(0,m.V$)(),{apiPut:I}=(0,m.kL)(),M=e=>{let a=[...n];a[e].isDropdownOpen=!n[e].isDropdownOpen,d(a)},W=e=>{q([...y.FH[e.value]]),w(e)},B=e=>{C([...y._I[e.value]]),T(e)},z=e=>{E(e)},_=e=>{let a=[...n];"Married"===e.value?a[h.anniversary].isInputHidden=!1:a[h.anniversary].isInputHidden=!0,d(a)},V=(e,a,l,r)=>{let i=[...n];i[a].isDropdownOpen=!1,i[a].value=e.label,i[a].error=null,"country"===r?W(e):"state"===r?B(e):"city"===r?z(e):"marital"===r&&_(e),d(i)},Z=(e,a,l,r)=>{let i={...o};i[r]=a,f(i);let t=[...n];t[e].isDropdownOpen=l,d(t)},X=(e,a)=>{let l=[];(null==e?void 0:e.length)&&e.length>1?(P.forEach(a=>{a.label.toLowerCase().includes(e.toLowerCase())&&l.push(a)}),(null==l?void 0:l.length)&&Z(a,l,!0,"state")):e&&e.length||Z(a,l,!1,"state")},J=(e,a)=>{let l=[];(null==e?void 0:e.length)&&e.length>1?(k.forEach(a=>{a.label.toLowerCase().includes(e.toLowerCase())&&l.push(a)}),(null==l?void 0:l.length)&&Z(a,l,!0,"city")):e&&e.length||Z(a,l,!1,"city")},H=(e,a,l)=>{"state"===l?X(e,a):"city"===l&&J(e,a)},U=(e,a,l,r)=>{let i=[...n];i[a].value=e,i[a].error=null,r&&H(e,a,r),d(i)},K=e=>{let a=[...n],l=n[e].isPasswordVisible;a[e].keyboardType=l?"password":"default",a[e].isPasswordVisible=!l,d(a)},Y=async()=>{let e=await D(n[h.name].value),r=await O(n[h.email].value),i=await L(n[h.password].value);if(e&&r&&i){var o,u,p,y;let e;R(!0);let r="".concat(c.kh.qfferAPI,"/customer/web/profile"),i={name:n[h.name].value,email:l.email?l.email:n[h.email].value.toLowerCase(),phone:l.phone?l.phone:"".concat(n[h.phone].countryCodeValue).concat(n[h.phone].value),deviceId:null,referralCode:n[h.referral].value?null===(o=n[h.referral].value)||void 0===o?void 0:o.toUpperCase():null,dateOfBirth:n[h.dob].value,address:n[h.address].value,gender:n[h.gender].value,state:n[h.state].value,city:n[h.city].value,country:n[h.country].value,maritalStatus:n[h.marital].value,anniversaryDate:n[h.anniversary].value,acceptChannelCommunications:n[h.checkBox].value};l.isPasswordSet||(i.password=n[h.password].value);let d=JSON.stringify(i);try{e=await I(r,d,null,t)}catch(e){A("Something went wrong! Please try again after some time."),R(!1)}(null===(u=e)||void 0===u?void 0:u.message)==="success"?(null===(y=e.body)||void 0===y?void 0:y.isEmailVerified)?s():a(d):(null===(p=e)||void 0===p?void 0:p.message)==="failure"&&e.body?A(e.body):A("Something went wrong! Please try again after some time."),R(!1)}else{let a=[...n];e||(a[h.name].error=await F(n[h.name].value,"name")),r||(a[h.email].error=await F(n[h.email].value,"email")),i||(a[h.password].error=await F(n[h.password].value,"password")),d(a)}},G=()=>{let e=!0;return n.forEach(a=>{a.isRequired&&!a.value&&(e=!1)}),!e};(0,i.useEffect)(()=>{if(l){let e=[...n];l.name&&(e[h.name].value=l.name),l.email&&(e[h.email].value=l.email,e[h.email].isDisabled=!0),l.phone&&(e[h.phone].value=l.phone,e[h.phone].isDisabled=!0),l.isPasswordSet&&(e[h.password].value="**********",e[h.password].isDisabled=!0),l.gender&&(e[h.gender].value=l.gender),l.dateOfBirth&&(e[h.dob].value=l.dateOfBirth),l.address&&(e[h.address].value=l.address),l.country&&(e[h.country].value=l.country),l.state&&(e[h.state].value=l.state),l.city&&(e[h.city].value=l.city),l.referralCode&&(e[h.referral].value=l.referralCode),l.maritalStatus&&(e[h.marital].value=l.maritalStatus,"Married"===l.maritalStatus&&(e[h.anniversary].isInputHidden=!1)),l.anniversary&&(e[h.anniversary].value=l.anniversary),d(e)}},[l]);let Q=(0,i.useMemo)(()=>G(),[n]);return(0,r.jsxs)("form",{className:"qb-signup-form px-md-5 py-5 d-flex flex-column align-items-stretch",id:"qb-signupform",children:[(0,r.jsx)("h3",{className:"qb-title mb-0 pb-4 qb-signup-title-text",children:"Complete Profile"}),(0,r.jsx)("div",{className:"container-fluid px-0 pt-md-0",children:(0,r.jsxs)("div",{className:"row gy-3",children:[n.map((e,a)=>e.isInputHidden?null:(0,r.jsx)("div",{className:"col-12 col-lg-".concat(e.inputWidthSize),children:e.inputFieldType&&"SELECT_TYPE"===e.inputFieldType?(0,r.jsx)(u.jL,{value:e.value,id:e.id,index:a,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,inputAllowed:!0,options:o[e.selectBoxType],isDropdownOpen:e.isDropdownOpen,onClick:M,onChange:U,onSelect:V}):e.inputFieldType&&"SELECT"===e.inputFieldType?(0,r.jsx)(u.jL,{value:e.value,id:e.id,index:a,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,options:o[e.selectBoxType],isDropdownOpen:e.isDropdownOpen,onClick:M,onChange:U,onSelect:V}):e.inputFieldType&&"MULTI_LINE"===e.inputFieldType?(0,r.jsx)(u.zC,{value:e.value,id:e.id,index:a,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,isDisabled:e.isDisabled,onChange:U}):e.inputFieldType&&"CHECKBOX"===e.inputFieldType?(0,r.jsx)(u.Jg,{value:e.value,id:e.id,index:a,label:e.label,error:e.error,isDisabled:e.isDisabled,onChange:U}):(0,r.jsx)(u.Wz,{value:e.value,id:e.id,index:a,label:e.label,placeholder:e.placeholder,fieldname:e.fieldname,error:e.error,isRequired:e.isRequired,fieldType:e.keyboardType,isPassword:e.isPassword,showPassword:e.isPasswordVisible,isDisabled:e.isDisabled,onViewPassword:K,onChange:U})},"input-".concat(a))),(null==j?void 0:j.length)?(0,r.jsx)("div",{className:"col-12",children:(0,r.jsx)("p",{className:"qb-input-error-message mt-1 qb-general-error qb-error-active",children:j})}):null,(0,r.jsx)("div",{className:"col-lg-12",children:(0,r.jsx)("div",{className:"w-100 pt-md-3 pt-3 d-flex flex-column flex-md-row align-items-stretch align-items-md-center justify-content-end",children:(0,r.jsx)(p.K,{id:"qb-profile-btn",isDisabled:Q,isLoading:N,onDisabledClick:()=>{let e=[...n];n.forEach((a,l)=>{a.isRequired&&!a.value&&(e[l].error=a.emptyErrorMessage?a.emptyErrorMessage:"Required field. Please fill this field to continue.")}),d([...e])},onClick:Y,children:(0,r.jsxs)(r.Fragment,{children:["Signup",(0,r.jsx)("span",{className:"qb-btn-loader ms-2"})]})})})})]})})]})},g=l(2539),w=l(8473),x=l(6775),T=()=>{let[e,a]=(0,i.useState)("PROFILE"),[l,t]=(0,i.useState)(!1),[u,p]=(0,i.useState)(null),[y,h]=(0,i.useState)(null),[v,b]=(0,i.useState)(!1),[T,S]=(0,i.useState)(null),[E,P]=(0,i.useState)(null),[q,k]=(0,i.useState)(!1),[C,j]=(0,i.useState)(""),{apiPost:A,apiGet:N}=(0,m.kL)(),{breakDownUrl:R}=(0,m.ZN)(),D=(0,n.useRouter)(),O=()=>{a("PROFILE")},L=()=>{O(),b(!0)},F=(e,a)=>{P({title:e,message:a}),k(!0)},I=async(e,a)=>{let l="".concat(c.kh.qfferAPI,"/customer/auth/verify/cx/email/").concat(e),r=JSON.stringify({value:a});try{await A(l,r)}catch(e){}},M=async e=>{let a,l="".concat(c.kh.qfferAPI,"/customer/web/profile");try{return a=await N(l,null,e)}catch(e){return a}},W=async e=>{var a;let l=await M(e);if(l&&"success"===l.message){let e="/auth/login";(null==l?void 0:null===(a=l.body)||void 0===a?void 0:a.amx)&&"".concat(e,"?amx=").concat(l.body.amx),j(e),t(!0),h(l.body)}else(null==l?void 0:l.message)&&"failure"===l.message&&l.body&&"Something went wrong"!=l.body?setTimeout(()=>{F("Invalid link",l.body)},300):setTimeout(()=>{F("Invalid link","Oops! this link seems to be expired or broken, Please try again with another link.")},300)},B=async()=>{var e,a,l;let r=window.location.href,i=await R(r);(null===(e=i.queries)||void 0===e?void 0:e.tx)?(S(i.queries.tx),W(i.queries.tx)):setTimeout(()=>{F("Invalid link","Oops! this link seems to be expired or broken, Please try again with another link.")},1e3),(null===(a=i.queries)||void 0===a?void 0:a.cx)&&(null===(l=i.queries)||void 0===l?void 0:l.k)&&await I(i.queries.k,i.queries.cx)};return(0,i.useEffect)(()=>{B()},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s(),{children:(0,r.jsx)("title",{children:"Qffer | Profile"})}),l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{children:"PROFILE"===e?(0,r.jsx)(f,{navigateToOtp:e=>{p(JSON.parse(e)),a("OTP")},customerDetails:y,token:T,successPopup:L}):(0,r.jsx)(d.Z,{authType:"PROFILE",user:u,handleSuccess:L,token:T})}),(0,r.jsx)(g.Z,{isVisible:v,handleBackdropClick:()=>{b(!1),D.push(C)},title:"Welcome Aboard",message:"Congratulations on signing up for our loyalty program. Stay Tuned! Exciting offers and loyalty rewards are on your way."})]}):(0,r.jsx)(w.Z,{removePreloader:l,loaderType:"BASE"}),(0,r.jsx)(x.Z,{isVisible:q,handleBackdropClick:()=>{},title:null==E?void 0:E.title,message:null==E?void 0:E.message})]})}}},function(e){e.O(0,[675,775,912,774,888,179],function(){return e(e.s=2365)}),_N_E=e.O()}]);